---
import "@fontsource/maple-mono/400.css";
import "@fontsource/maple-mono/400-italic.css";
import "@fontsource-variable/lexend";
import "@fontsource-variable/inter-tight";

import lexendWoff2 from "@fontsource-variable/lexend/files/lexend-latin-wght-normal.woff2?url";
import mapleNormalWoff2 from "@fontsource/maple-mono/files/maple-mono-latin-400-normal.woff2";
import mapleItalicWoff2 from "@fontsource/maple-mono/files/maple-mono-latin-400-italic.woff2";
import interTightWoff2 from "@fontsource-variable/inter-tight/files/inter-tight-latin-wght-normal.woff2?url";

import "./style/base.scss";

import Nav from "@/components/Nav";
import Footer from "@/components/Footer";

type Props = {
  pageTitle?: string;
  pageDescription?: string;
};

const { pageTitle, pageDescription } = Astro.props;

const siteTitle = "Price Hiller's Blog";
let title = siteTitle;
if (pageTitle != undefined) {
  title = `${pageTitle} | ${title} `;
}

// Evil shit done here to avoid a white flash when a page is loaded on a slow
// or high latency connection
import * as sass from "sass";
import Wave from "@/style/theme/_wave.module.scss";

const minCss = sass.compileString(
  `
  html {
    background-color: ${Wave.sumiInk0};
    color: ${Wave.fujiWhite};
  }
  `,
  {
    style: "compressed",
  },
).css;
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{title}</title>
    <meta
      name="description"
      content={pageDescription ?? "Price Hiller's Blog"}
    />
    <meta name="color-scheme" content="dark" />
    <link rel="sitemap" href="/sitemap-index.xml" />
    <link
      rel="preload"
      as="font"
      type="font/woff2"
      href={mapleNormalWoff2}
      crossorigin="anonymous"
    />
    <link
      rel="preload"
      as="font"
      type="font/woff2"
      href={mapleItalicWoff2}
      crossorigin="anonymous"
    />
    <link
      rel="preload"
      as="font"
      type="font/woff2"
      href={lexendWoff2}
      crossorigin="anonymous"
    />
    <link
      rel="preload"
      as="font"
      type="font/woff2"
      href={interTightWoff2}
      crossorigin="anonymous"
    />
    <style is:inline set:html={minCss}></style>
  </head><div id="main-menu">
    <Nav />
  </div>
  <script>
    // Ensure the main content is focused so page down and page up works
    // without needing to click -- makes it less of a pain for navigating via
    // keyboard
    document.querySelector("main")?.focus();
  </script>

  <body>
    <main>
      <slot />
    </main>
    <Footer />
  </body>
</html>
